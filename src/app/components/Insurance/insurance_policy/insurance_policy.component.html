<div class="contain-inter" >
    <div style="float:right">
        <button id="receipt" nzType="primary" nz-button (click)="generateQuotation()">Generate Quotation</button>
    </div>
    <app-page-header [HeaderItems]="pageHeader" (initPage)="reset()"></app-page-header>
    <button id="saveButton" style="display:none" (click)="savePolicy()">Save</button>  
    <button id="previousButton" style="display:none" (click)="pre()">Previous</button>  
    <!-- <div style="width:100%;display:inline-block;border-bottom: orangered 1px solid;">
        <button id="round" nzShape="circle" nz-button nzType="primary" (click)="reset();init()"  ><i nz-icon nzType="reload"></i></button>
        <h2 style="float:left;"><span>Insurance Policy</span></h2>
        <div style="float:right">
            <nz-button-group nzSize="small" class="tableBut" >
                <button nzType="primary" nz-button
                    (click)="savePolicy()">Save / 保存记录</button>
            </nz-button-group>
        </div>
    </div> -->
    <div class="tableShow-area"  style="height: fit-content;">
        <div class="tableShow-table" [formGroup]="policyGroup" >                                           
            <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-top;">
                <div style="width: 50%;">
                    <label class="displayText">Insured Client ：</label>
                    <nz-form-item>
                        <nz-form-control nzErrorTip="Insurance Client Name is required!">
                          <nz-input-group>
                            <nz-select nzShowSearch class="inputWidth" 
                            formControlName="insuranceClient_index"   
                            [(ngModel)]="insurance_id" (ngModelChange)="InsuranceClientChange($event)"                          
                                nzPlaceHolder="Select a Insurance Client">
                                <!-- <nz-option nzCustomContent>
                                    <button nzType="primary" nz-button
                                    (click)="addInsuranceClient()">Add New Insurance Client</button>
                                </nz-option> -->
                                <ng-container *ngFor="let p of InsuranceClient, let i = index">
                                    <nz-option *ngIf="!InsuranceClientLoadSel" [nzValue]="p.id" [nzLabel]="p.name"></nz-option>
                                </ng-container>
                                <nz-option *ngIf="InsuranceClientLoadSel" nzDisabled nzCustomContent>
                                    <i nz-icon nzType="loading" class="loading-icon"></i> Loading Data...
                                </nz-option>
                            </nz-select>      
                          </nz-input-group>
                        </nz-form-control>
                     </nz-form-item>                     
                </div>
                <div style="width:50%">
                    <label class="displayText">Product Type:</label>                                            
                    <nz-form-item>
                        <nz-form-control nzErrorTip="Product Type is required!">
                            <nz-input-group > 
                                <nz-select nzShowSearch class="inputWidth" [(ngModel)]="product_type"  
                                    formControlName="product_type"                       
                                    nzPlaceHolder="Select a Policy Type">
                                    <!-- <nz-option nzCustomContent>
                                        <button nzType="primary" nz-button
                                        >Add Product Type</button>
                                    </nz-option> -->
                                    <ng-container *ngFor="let p of ProductTypes, let i = index">
                                        <nz-option *ngIf="!ProductTypeLoadSel" [nzValue]="p.id" [nzLabel]="p.description"></nz-option>
                                    </ng-container>
                                    <nz-option *ngIf="ProductTypeLoadSel" nzDisabled nzCustomContent>
                                        <i nz-icon nzType="loading" class="loading-icon"></i> Loading Data...
                                    </nz-option>
                                </nz-select>       
                            </nz-input-group>
                        </nz-form-control>
                    </nz-form-item>
                </div>
            </div>
            <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">
                <div style="width:50%">
                    <label class="displayText">Policy No :</label>                                                                
                    <nz-form-item>
                        <nz-form-control nzErrorTip="Policy No is required!">
                            <nz-input-group >                                 
                                <input nz-input [(ngModel)]="policy_no" formControlName="policy_no"  class="inputWidth" />     
                            </nz-input-group>
                        </nz-form-control>
                    </nz-form-item>
                </div>
                <div style="width:50%">
                    <label class="displayText">Insured Name :</label>
                    <nz-form-item>
                        <nz-form-control nzErrorTip="Insured Name is required!">
                            <nz-input-group >                                 
                                <input nz-input [(ngModel)]="insured_object" formControlName="insured_object"  class="inputWidth" />     
                            </nz-input-group>
                        </nz-form-control>
                    </nz-form-item>
                </div> 
            </div>      
            <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-top;">  
                <div style="width:50%">
                    <label class="displayText">Insured Date：</label>
                    <nz-form-item>
                        <nz-form-control nzErrorTip="Insured Date is required!">
                            <nz-input-group >                                 
                                <input nz-input [(ngModel)]="insured_date" formControlName="insured_date" type="date" (ngModelChange)="dateChange($event)" class="inputWidth" />
                            </nz-input-group>
                        </nz-form-control>
                    </nz-form-item>
                </div>           
                <div style="width:50%">
                    <label class="displayText">Renewal Date :</label>  
                    <nz-form-item>
                        <nz-form-control nzErrorTip="Renewal Date is required!">
                            <nz-input-group >                                 
                                <input nz-input [(ngModel)]="renewal_date" formControlName="renewal_date" type="date" class="inputWidth" />
                            </nz-input-group>
                        </nz-form-control>
                    </nz-form-item>
                </div>
            </div>
            <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">                
                <div style="width:50%">
                    <label class="displayText">Content Value：</label>  
                    <nz-form-item>
                        <nz-form-control nzErrorTip="Content Value is required!">
                            <nz-input-group nzSuffix="MYR" nzPrefix="RM">                           
                                <input nz-input [(ngModel)]="content_value" formControlName="content_value" type="number" class="inputWidth" />
                            </nz-input-group>
                        </nz-form-control>
                    </nz-form-item>
                </div>
                <div style="width:50%">
                    <label class="displayText">Plan Covered:</label>
                    <nz-form-item>
                        <nz-form-control nzErrorTip="Plan Covered is required!">
                            <nz-input-group >                   
                                <nz-select nzShowSearch class="inputWidth" [(ngModel)]="product_type"  
                                    formControlName="plan_covered"                       
                                    nzPlaceHolder="Select a Plan TYpe">
                                    <ng-container *ngFor="let p of PlanType">
                                        <nz-option *ngIf="PlanType" [nzValue]="p.id" [nzLabel]="p.description"></nz-option>
                                    </ng-container>
                                    <nz-option *ngIf="!PlanType" nzDisabled nzCustomContent>
                                        <i nz-icon nzType="loading" class="loading-icon"></i> Loading Data...
                                    </nz-option>
                                </nz-select>              
                                <!-- <input nz-input [(ngModel)]="plan_covered" formControlName="plan_covered"  class="inputWidth" />      -->
                            </nz-input-group>
                        </nz-form-control>
                    </nz-form-item>
                </div>
            </div>
            <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">  
                <div style="width:100%">
                    <label class="displayText">Company :</label>
                    <nz-form-item>
                        <nz-form-control nzErrorTip="Company Name is required!">
                            <nz-input-group >              
                                <nz-select nzShowSearch class="inputWidth" [(ngModel)]="company_index"
                                    formControlName="company_index"           
                                    nzPlaceHolder="Select a Company">
                                    <nz-option nzCustomContent>
                                        <button nzType="primary" nz-button>Add New Company Provider</button>                                            
                                    </nz-option>
                                    <ng-container *ngFor="let p of Companies, let i = index">
                                        <nz-option *ngIf="!CompanyLoadSel" [nzValue]="p.id" [nzLabel]="p.description"></nz-option>
                                    </ng-container>
                                    <nz-option *ngIf="CompanyLoadSel" nzDisabled nzCustomContent>
                                        <i nz-icon nzType="loading" class="loading-icon"></i> Loading Data...
                                    </nz-option>
                                </nz-select>         
                            </nz-input-group>
                        </nz-form-control>
                    </nz-form-item> 
                </div>
            </div> 
        </div> 
        <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">
            <div style="width:50%">
                <label class="displayText">Refer No：</label>
                <input nz-input [(ngModel)]="refer_no" class="inputWidth" />
            </div>
        </div> 
        <br/>
        <br/>
        <div class="premium">
            <div style="width:100%;display:inline-block;border-bottom: orangered 1px solid;">
                <h2 style="float:left;"><span>Premium</span></h2>
            </div>
            <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">
                <div style="width:50%">
                    <label class="displayText">Premium :</label>
                    <nz-input-group nzSuffix="MYR" nzPrefix="RM">
                        <input nz-input type="number" (change)="calculator($event)" [(ngModel)]="premium"/>
                    </nz-input-group>
                </div>
                <div style="width:50%">
                    <label class="displayText">Commission：</label>
                    <nz-input-group nzSuffix="MYR" nzPrefix="RM">
                        <input nz-input type="number" (change)="calculator($event)" [(ngModel)]="commission"/>
                    </nz-input-group>
                </div>
            </div> 
            <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">
                <div style="width:50%">
                    <label class="displayText">GST Charge:</label>
                    <nz-input-group nzSuffix="MYR" nzPrefix="RM">
                        <input nz-input type="number"  [(ngModel)]="gst"/>
                    </nz-input-group>
                </div>
                <div style="width:50%">
                    <label class="displayText">Stamp Duty：</label>
                    <nz-input-group nzSuffix="MYR" nzPrefix="RM">
                        <input nz-input type="number" [(ngModel)]="stamp_duty" disabled/>
                    </nz-input-group>
                </div>
            </div>
            <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-top;">
                <div style="width:50%">
                    <label class="displayText">Net Amount:</label>
                    <nz-input-group nzSuffix="MYR" nzPrefix="RM">
                        <input nz-input type="number" [(ngModel)]="net_amount" disabled/>
                    </nz-input-group>
                </div>
                <div style="width:50%">
                    <label class="displayText">Road Tax :</label>
                    <nz-form-item>
                        <nz-form-control nzErrorTip="Road Tax is required!">
                            <nz-input-group nzSuffix="MYR" nzPrefix="RM">
                                <input nz-input type="number" (change)="calculator($event)" [(ngModel)]="road_tax" />
                            </nz-input-group>
                        </nz-form-control>
                    </nz-form-item>
                </div>      
            </div>
            <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">
                <div style="width:50%">
                    <label class="displayText">Service Charge :</label>                         
                    <nz-form-item>
                        <nz-form-control nzErrorTip="Service Charge is required!">
                            <nz-input-group nzSuffix="MYR" nzPrefix="RM">
                                <input nz-input type="number" (change)="calculator($event)" [(ngModel)]="service_charges" />
                            </nz-input-group>
                        </nz-form-control>
                    </nz-form-item>
                </div>
                <div style="width:50%">
                    <label class="displayText">Postage :</label>    
                    <nz-form-item>
                        <nz-form-control nzErrorTip="Postage is required!">
                            <nz-input-group nzSuffix="MYR" nzPrefix="RM">
                                <input nz-input type="number" (change)="calculator($event)" [(ngModel)]="postage" />
                            </nz-input-group>
                        </nz-form-control>
                    </nz-form-item> 
                </div>
            </div>
            <div style="width:50%">
                <label class="displayText">Others :</label>                          
                <nz-form-item>
                    <nz-form-control nzErrorTip="Other is required!">
                        <nz-input-group nzSuffix="MYR" nzPrefix="RM">
                            <input nz-input type="number" (change)="calculator($event)" [(ngModel)]="other" />
                        </nz-input-group>
                    </nz-form-control>
                </nz-form-item>
            </div>
            
            <div style="width:50%">
                <label class="displayText">Final Amount :</label>                          
                <nz-form-item>
                    <nz-form-control nzErrorTip="Final Amount is required!">
                        <nz-input-group nzSuffix="MYR" nzPrefix="RM">
                            <input nz-input type="number" [(ngModel)]="finalAmount" disabled/>
                        </nz-input-group>
                    </nz-form-control>
                </nz-form-item>
            </div>
        </div> 
        <div class="non-vehicle">                
            <div style="width:100%;display:inline-block;border-bottom: orangered 1px solid;">
                <h2 style="float:left;"><span>Non-Vehicle</span></h2>
            </div>
            <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">
                <div style="width:50%">
                    <label class="displayText">Risk ：</label>
                    <input nz-input [(ngModel)]="risk" class="inputWidth" />
                </div>
                <div style="width:50%">
                    <label class="displayText">Building Basic Rate:</label>
                    <input nz-input [(ngModel)]="building_basic_rate" class="inputWidth" />
                </div>
            </div>
            <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">
                <div style="width:50%">
                    <label class="displayText">Content Basic Rate:</label>
                    <input nz-input [(ngModel)]="content_basic_rate" class="inputWidth" />
                </div>
            </div>
            <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">
                <div style="width:50%">
                    <label class="displayText">Construction Class：</label>
                    <input nz-input [(ngModel)]="contruction_class" class="inputWidth" />
                </div>
                <div style="width:50%">
                    <label class="displayText">Rate Status:</label>
                    <input nz-input [(ngModel)]="rate_status" class="inputWidth" />
                </div>
            </div>
            <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">
                <div style="width:50%">
                    <label class="displayText">Occupied As：</label>
                    <input nz-input [(ngModel)]="occupied_as" class="inputWidth" />
                </div>
                <div style="width:50%">
                    <label class="displayText">Piam Code:</label>
                    <input nz-input [(ngModel)]="piam_code" class="inputWidth" />
                </div>
            </div>
            <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">
                <div style="width:50%">
                    <label class="displayText">Fire Lighting Rate：</label>
                    <input nz-input [(ngModel)]="fire_lighting_rate" class="inputWidth" />
                </div>
                <div style="width:50%">
                    <label class="displayText">Riot Strike Damage:</label>
                    <input nz-input [(ngModel)]="riot_strike_damage" class="inputWidth" />
                </div>
            </div> 
        </div>
        <div class="vehicle">
            <div style="width:100%;display:inline-block;border-bottom: orangered 1px solid;">
                <h2 style="float:left;"><span>Vehicle</span></h2>
            </div> 
            <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">                    
                <div style="width:50%">
                    <label class="displayText">Year In Make：</label>
                    <nz-date-picker style="width:100%" nzMode="year" [(ngModel)]="year_in_make" nzFormat="yyyy"></nz-date-picker>
                </div>
                <div style="width:50%">
                    <label class="displayText">Engine:</label>
                    <input nz-input [(ngModel)]="engine" class="inputWidth" />
                </div>
            </div>
            <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">
                <div style="width:50%">
                    <label class="displayText">Chasis：</label>
                    <input nz-input [(ngModel)]="chasis" class="inputWidth" />
                </div>
                <div style="width:50%">
                    <label class="displayText">Make Body:</label>
                    <input nz-input [(ngModel)]="make_body" class="inputWidth" />
                </div>
            </div>
            <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">
                <div style="width:50%">
                    <label class="displayText">Type Of Body：</label>
                    <input nz-input [(ngModel)]="type_of_body" class="inputWidth" />
                </div>
                <div style="width:50%">
                    <label class="displayText">CC:</label>
                    <input nz-input [(ngModel)]="cc" class="inputWidth" />
                </div>
            </div>
            <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">
                <div style="width:50%">
                    <label class="displayText">Wind Screen (Value)：</label>
                    <nz-input-group nzSuffix="MYR" nzPrefix="RM">
                        <input type="number" nz-input [(ngModel)]="wind_screen" />
                    </nz-input-group>
                </div>
                <div style="width:50%">
                    <label class="displayText">E-Hailing:</label>
                    <nz-input-group nzSuffix="MYR" nzPrefix="RM">
                        <input type="number" nz-input [(ngModel)]="e_hailing" />
                    </nz-input-group>
                </div>
            </div> 
        </div>
    </div>
</div>
<ngx-loading [show]="isVisible" [config]="{ backdropBorderRadius: '3px'}" [template]="customLoadingTemplate">
</ngx-loading>
<nz-modal [(nzVisible)]="isModalVisible" nzTitle="Add Insurance Client" (nzOnCancel)="handleCancel()">
    <app-insurance_client (returnResult)="getValue($event)" ></app-insurance_client>
</nz-modal>