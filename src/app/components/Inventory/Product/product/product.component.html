<div class="contain-inter">
    <app-page-header [HeaderItems]="pageHeader" (initPage)="init()"></app-page-header>  
    <!-- <app-page-header [HeaderItems]="pageHeader"></app-page-header>    -->
    <button id="saveButton" style="display:none" (click)="saveProduct()"></button> 
    <div class="tableShow-area"  style="height: fit-content;">
        <div class="tableShow-table" >
            <!-- <div *ngIf="pageMode=='Detail'" nz-row style="display: flex;width: 100%;">
                <div style="width: 100%;">
                    <label class="displayText">Product Name / 货名 :</label>
                    <nz-select nzShowSearch class="inputWidth"
                        [(ngModel)]="Product.id"
                        (ngModelChange)="ItemChange($event)"                    
                        nzPlaceHolder="Select a Solution">
                        <ng-container *ngFor="let p of Items; let i = index">Items
                            <nz-option  *ngIf="Items" [nzValue]="p.id" [nzLabel]="p.code + '-' + p.name"></nz-option>
                        </ng-container>                        
                        <nz-option *ngIf="!Items" nzDisabled nzCustomContent>
                            <i nz-icon nzType="loading" class="loading-icon"></i> Loading Data...
                        </nz-option>
                    </nz-select>
                </div>
            </div> -->
            <div style="width:100%">
                <div nz-row style="display: flex;width: 100%;margin-top: 10px;">                   
                    <div style="width:100%">
                        <label class="displayText">Type Category / 种类归类 :</label>
                            <nz-input-group>
                            <nz-select class="inputWidth" #productTypeselect
                            [(ngModel)]="productCategory"
                            (ngModelChange)="typeCategoryChange($event)"   
                                nzPlaceHolder="Select a Type Category" >
                                <ng-container *ngFor="let p of TypeCategory">
                                    <nz-option *ngIf="TypeCategory" 
                                    [nzValue]="p.id" [nzLabel]="p.description"></nz-option>
                                </ng-container>
                                <nz-option *ngIf="!TypeCategory" nzDisabled nzCustomContent>
                                    <i nz-icon nzType="loading" class="loading-icon"></i> Loading Data...
                                </nz-option>
                            </nz-select>        
                            </nz-input-group>
                    </div>
                </div>
            </div>
            <div style="width:100%" [formGroup]="productForm">
                <div nz-row style="display: flex;width: 100%;margin-top: 10px;">                   
                    <div style="width:100%">
                        <label class="displayText">Product Type / 货品种类 :</label>
                        <nz-form-item>
                            <nz-form-control nzErrorTip="Product Type is required!">
                              <nz-input-group>
                                <nz-select class="inputWidth" #productTypeselect
                                [(ngModel)]="Product.type" formControlName="type"
                                (ngModelChange)="productTypeChange($event)"   
                                    nzPlaceHolder="Select a Product Type" >
                                    <ng-container *ngFor="let p of ProductTypes">
                                        <nz-option *ngIf="ProductTypes" 
                                        [nzValue]="p.id" [nzLabel]="p.description"></nz-option>
                                    </ng-container>
                                    <nz-option *ngIf="!ProductTypes" nzDisabled nzCustomContent>
                                        <i nz-icon nzType="loading" class="loading-icon"></i> Loading Data...
                                    </nz-option>
                                </nz-select>        
                              </nz-input-group>
                            </nz-form-control>
                        </nz-form-item>  
                    </div>
                </div>
                <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">                                        
                </div>
                <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">
                    <div style="width:50%">
                        <label class="displayText">Product Code / 货品代码 :</label>
                        <nz-form-item>
                            <nz-form-control nzErrorTip="Product Code is required!">
                              <nz-input-group>
                                <input nz-input class="inputWidth" [(ngModel)]="Product.code" formControlName="code"/>
                              </nz-input-group>
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                    <div style="width:50%">
                        <label class="displayText">Product Name /  货品名字 :</label>
                        <nz-form-item>
                            <nz-form-control nzErrorTip="Product Name is required!">
                              <nz-input-group>
                                <input nz-input class="inputWidth" [(ngModel)]="Product.name" formControlName="name"/>
                              </nz-input-group>
                            </nz-form-control>
                        </nz-form-item>                        
                    </div>                
                </div>                
                <div style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">
                    <div style="width:50%">
                        <label class="displayText">Unit Cost /  单价 :</label>
                        <nz-form-item>
                            <nz-form-control nzErrorTip="Unit Cost is required!">
                              <nz-input-group nzSuffix="MYR" nzPrefix="RM">
                                <input nz-input [(ngModel)]="Product.unitCost" formControlName="unit_cost" (change)="setPrice($event)"/>
                              </nz-input-group>
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                    <div *ngIf="productCategory!=2" style="width:50%">
                        <label class="displayText">Selling Price /  卖价 :</label>
                        <nz-form-item>
                            <nz-form-control nzErrorTip="Selling Price is required!">
                              <nz-input-group nzSuffix="MYR" nzPrefix="RM">
                                <input nz-input class="inputWidth" [(ngModel)]="Product.item.sellingPrice" formControlName="selling_price"/>
                              </nz-input-group>
                            </nz-form-control>
                        </nz-form-item>                          
                    </div>                       
                </div>                
                <div *ngIf="productCategory!=4">
                    <div nz-row style="display: flex;width: 100%;">
                        <div style="width: 100%;">
                            <label class="displayText">Supplier / 供应商 ：</label>
                            <!-- <nz-form-item>
                                <nz-form-control nzErrorTip="Supplier Name is required!"> -->
                                <nz-input-group>
                                    <nz-select nzShowSearch class="inputWidth" formControlName="supplier_index" 
                                    [(ngModel)]="Product.supplier.id"                         
                                        nzPlaceHolder="Select a Supplier">
                                        <ng-container *ngFor="let p of Suppliers, let i = index">
                                            <nz-option *ngIf="Suppliers" [nzValue]="p.id" [nzLabel]="p.name"></nz-option>
                                        </ng-container>
                                        <nz-option *ngIf="!Suppliers" nzDisabled nzCustomContent>
                                            <i nz-icon nzType="loading" class="loading-icon"></i> Loading Data...
                                        </nz-option>
                                    </nz-select>       
                                </nz-input-group>
                                <!-- </nz-form-control>
                            </nz-form-item>  -->
                        </div>
                    </div>
                </div>         
                <div *ngIf="productCategory==4">
                    <div nz-row style="display: flex;width: 100%;">
                        <div style="width: 100%;">
                            <label class="displayText">Option Group：</label>
                            <ng-container *ngFor="let o of optionGroups">
                                <div class="headerInfo">
                                    <div class="menuRow" style="padding: 5px" >
                                        <label nz-checkbox [nzChecked]="o.checked" (nzCheckedChange)="updateSingleChecked($event,o.id,o)">{{o.name}}</label>
                                    </div>
                                </div>      
                            </ng-container> 
                        </div>
                    </div>
                </div>
            </div>
            <div  class="additional_fields">
                
                <div style="width:100%;display:inline-block;border-bottom: orangered 1px solid;">
                    <h3 style="float:left;"><span>Additional Information</span></h3>
                </div>
                <div *ngIf="productCategory==1" style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">                       
                    <div style="width:50%">
                        <label class="displayText">BarCode:</label>
                        <!-- <nz-form-item>
                            <nz-form-control nzErrorTip="BarCode is required!"> -->
                              <nz-input-group>
                                <input nz-input class="inputWidth" [(ngModel)]="Product.barCode" />
                              </nz-input-group>
                            <!-- </nz-form-control>
                        </nz-form-item>    -->
                    </div> 
                </div>
                
                <div *ngIf="productCategory==1" style="display: flex;width: 100%;margin-top: 10px;align-items: flex-end;">
                    <div style="width:50%">
                        <label class="displayText">Weight (KG) /  重量 （公斤） :</label>
                        <!-- <nz-form-item>
                            <nz-form-control nzErrorTip="Weight is required!"> -->
                              <nz-input-group nzSuffix="KG">
                                <input nz-input class="inputWidth" [(ngModel)]="Product.weight" />
                              </nz-input-group>
                            <!-- </nz-form-control>
                        </nz-form-item>   -->
                    </div>
                    <div style="width:50%">
                        <label class="displayText">Size /  体积 :</label>
                        <!-- <nz-form-item>
                            <nz-form-control nzErrorTip="Size is required!"> -->
                              <nz-input-group>
                                <input nz-input class="inputWidth" [(ngModel)]="Product.dimension"/>
                              </nz-input-group>
                            <!-- </nz-form-control>
                        </nz-form-item>   -->
                    </div>
                </div>                 
                <div style="display: flex;width: 100%;margin-top: 10px;">   
                    <div class="img-space" style="display:grid; float:right;width:100%" >
                        <!-- <ng-container *ngIf="isImageSaved; else elseTemplate">
                            <img style="width:150px;height:150px" [src]="cardImageBase64" />
                        </ng-container>
                        <ng-template #elseTemplate>
                            <img src="" class="img-responsive" />  
                        </ng-template> -->
                        <div style="display: flex;">
                            <!-- <label style="height: 30px;line-height: 30px;margin-right: 13px;">Upload Product Picture</label> -->
                            <img style="width:150px;height:150px" [src]="cardImageBase64" />  
                            <a style="height: 30px;" class="btn btn-danger" (click)="removeImage()" *ngIf="isImageSaved">X</a>
                        </div>
                        <div>
                            <nz-input-group [nzAddOnAfter]="uploadsuffixButton">             
                                <input nz-input [(ngModel)]="imageFile" type="file" (change)="readURL($event)" class="fileInputProfile">       
                            </nz-input-group>
                            <ng-template #uploadsuffixButton>
                                <!-- <button nzShape="circle" nz-button nzType="primary" (click)="uploadPicture()" ><span nz-icon nzType="save" nzTheme="outline"></span></button>   -->
                            </ng-template>  
                        </div>
                        <div class="form-group">
                            <fieldset class="form-group">                
                                {{imageError}}
                                <!-- <div class="custom-file fileInputProfileWrap">
                                    <input nz-input [(ngModel)]="filename" type="file" (change)="fileChangeEvent($event)" class="fileInputProfile">
                                </div>--> 
                                
                                
                                <div nz-row style="display: flex;width: 100%;margin-top: 10px;">                   
                                    <div style="width:100%">
                                        <label class="displayText">Product Images:</label>
                                        <nz-input-group>
                                            <nz-select nzShowSearch class="inputWidth" #productTypeselect
                                            [(ngModel)]="cardImageBase64"
                                            (ngModelChange)="setImage()"   
                                                nzPlaceHolder="Select a Product Image" >
                                                <ng-container *ngFor="let p of ProductImage">
                                                    <nz-option *ngIf="ProductImage" 
                                                    [nzValue]="p.id" [nzLabel]="p.name"></nz-option>
                                                </ng-container>
                                                <nz-option *ngIf="!ProductImage" nzDisabled nzCustomContent>
                                                    <i nz-icon nzType="loading" class="loading-icon"></i> Loading Data...
                                                </nz-option>
                                            </nz-select>        
                                        </nz-input-group>
                                    </div>
                                </div>
                            </fieldset>                            
                        </div>                        
                    </div>                    
                </div> 
                                 
                <div style="display: flex;width: 100%;margin-top: 10px;">                    
                    <div style="width:100%">
                        <label class="displayText" style="vertical-align: top;">Description / 内容 :</label>
                        <!-- <nz-form-item>
                            <nz-form-control nzErrorTip="Description is required!"> -->
                              <nz-input-group>
                                <textarea rows="10" nz-input class="inputWidth" [(ngModel)]="Product.description" ></textarea>
                              </nz-input-group>
                            <!-- </nz-form-control>
                        </nz-form-item>   -->
                    </div>                   
                </div>   
            </div>
            <app-product_price_list *ngIf="productCategory==1 || productCategory == 4 " [notifier]="priceList" (seletedData)="getSeletedData($event)"></app-product_price_list>
        </div>    
    </div>
</div>
<ngx-loading [show]="isVisible" [config]="{ backdropBorderRadius: '3px'}" [template]="customLoadingTemplate">
</ngx-loading>